#!/bin/bash
set -x
## start code-generator "^\\s *#\\s *"
# generate-getopts rroot
## end code-generator
## start generated code
root=false
OPTIND=1
while getopts 'r' opt; do
    case "$opt" in
        r)    root=true;;
        *)    echo Usage Error;;
    esac
done
shift $(($OPTIND - 1))

## end generated code

if test $# = 1; then
    set -- "$1" "$(basename "$1"|perl -npe 's/pt-//')"
fi

if test "$root" = true; then
    root=-d
else
    root=
fi
adb-push $root $1 /data/; my-adb shell "dd if=/data/$(basename $1) of=\$(echo /dev/block/platform/*/by-name/$2)"
