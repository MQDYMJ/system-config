#!/bin/bash

# [[file:~/system-config/knuth-mode/emacs-append-file.org::*%E6%9C%80%E7%BB%88%E7%9A%84%E7%89%88%E6%9C%AC%EF%BC%9A][the-ultimate-script]]

set -e


## start code-generator "^\\s *#\\s *"
# generate-getopt f:from-file t:to_file
## end code-generator
## start generated code
TEMP=$( getopt -o f:t:h \
               --long from-file:,to_file:,help \
               -n $(basename -- $0) -- "$@")
declare from_file=
declare to_file=
eval set -- "$TEMP"
while true; do
    case "$1" in

        -f|--from-file)
            from_file=$2
            shift 2

            ;;
        -t|--to_file)
            to_file=$2
            shift 2

            ;;
        -h|--help)
            set +x
            echo -e
            echo
            echo Options and arguments:
            printf %06s '-f, '
            printf %-24s '--from-file=FROM_FILE'
            echo
            printf %06s '-t, '
            printf %-24s '--to_file=TO_FILE'
            echo
            exit
            shift
            ;;
        --)
            shift
            break
            ;;
        *)
            die "internal error"
            ;;
    esac
done


## end generated code

if test ! -e "$from_file"; then
    die "FROM-FILE $from_file non-exist"
fi

if test ! -e "$to_file"; then
    die "TO-FILE $to_file non-exist"
fi

emacsclient -e "$(cat <<EOF16d93b20dc6b
(progn
  (find-file "$to_file")
  (goto-char (point-max))
  (insert-file "$from_file")
  (save-buffer))
EOF16d93b20dc6b
)"
# Local Variables: #
# eval: (read-only-mode 1) #
# End: #

# the-ultimate-script ends here
