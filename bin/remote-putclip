#!/bin/bash

set -xe
unset REMOTEIP
EMACS=t
. ~/system-config/bin/set-ssh-agent

if [[ $1 =~ \#[0-9]+ ]]; then
    port=$(echo "$1" | perl -npe 's/.*#(\d+):.*/$1/')
    set -- "$(echo "$1" | perl -npe 's/#(\d+):/:/')"
else
    port=22
fi
scp -P $port "$1" /tmp/remote-putclip.$$
DISPLAY=:0
. ~/.renew-xauth
cat /tmp/remote-putclip.$$ | putclip
rm /tmp/remote-putclip.$$

