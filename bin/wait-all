#!/bin/bash

wait() {
    local p
    local ret=0
    for p in $(jobs -p); do
        if ! builtin wait "$p"; then
            ret=1
        fi
    done
    return $ret
}


if ! wait; then
    die "有些后台程序非正常退出了。。。"
fi
