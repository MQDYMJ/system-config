#+title: 小扳手 +2.0版+ 使用手册
# bhj-tags: tool
* 小扳手是什么

打过游戏没有？打游戏作过弊没有？兄弟我以前打真侍魂，霸王丸有一个绝招非常变态，叫天霸封神斩，在手柄上要按↘←↙↓↘→←↓↙·B+C 才能按出来，因为我们玩的是PC版，在键盘上就更不好按了。这时有人想出了一个很妙的主意：用按键小精灵！以后只要按一个键就能发天霸封神斩了，这就是作弊啊！开挂啊！🃏

小扳手就相当于是手机上的按键小精灵，你可以在PC上输入，然后通过手机发送！怎么样，是不是挂开得有点大了？想想你的朋友们都在手机上一个字一个字的打完再发朋友圈，你可以在PC键盘上运指如飞，打出一篇又一篇的美文，打得你的朋友们满地找牙，不亦乐乎！😄

(*2017-02-07 更新* 关于上面这段话，如果你脑子像我一样，基本上是不可能打出什么“美文”来的，没错，美文的关键不在于在PC键盘上“运指如飞”，而在于脑子和训练...)

您可以看一下 [[http://weibo.com/1611427581/BySpXjTic][这条微博]] 里边的这个视频，小扳手在不停地帮我约陌陌呢！😻从视频里您应该可以看到，正常的人类控制手机是不可能做到这么精准的。😅 另外可以看一下小扳手 [[http://v.youku.com/v_show/id_XMTMzOTY5NTQyNA][最新的介绍视频]]，以及这个 [[http://www.bilibili.com/video/av6403550][小扳手流畅同步手机屏幕显示]]。

告诉你一个秘密！在微信朋友圈里发文章，是不是大家发出来的文章都像浆糊一样糊在一块儿，根本没有分段的概念？你可以在输入的时候空一行——这看上去就是分了段了——但是没用的，微信会自动把你的空行给“吃”掉，发出来的东西还是糊在一起的。但是如果用小扳手，你就可以发出分段的文章！😸（*2017-02-20 更新* 最新版本的微信可能早已解决了这个问题。另外本文写作时候跨度较长，其中描述难免有些会过时，恕不能一一更正）

* 小扳手能干什么

小扳手可厉害啦！它是锤子科技的一个热心员工（也就是区区在下🙇）专门为锤子科技出品的Smartisan T1手机开发的（其他厂商的手机有的也可以，在后面会说），主要功能有：

1. 聊天

   - 陌陌（这个您已经看过视频了）
   - 微信
   - QQ
   - 微博私信
   - 旺旺
   - 其它聊天界面与陌陌类似的安卓应用，比如发短信

   其中，微信、QQ、微博私信这三个应用聊天的时候是支持发送PC上的图片和截屏的。

2. 同步流畅的显示手机屏幕

   见 [[http://www.bilibili.com/video/av6403550/][这个bilibili视频]]。

3. 回复短信

   收到一条短信之后，在Smartisan T1手机上，您可以直接操作小扳手进行回复，非常简单：输入想要回复的内容，然后发送。这个是特别针对Smartisan T1手机做过适配的，精确的知道系统收到短信的界面应该怎么用“按键小精灵”进行操作（其他厂商的手机应该是不能用的）。

   [[./../../../../images/wrench-reply-sms.png][file:../../../../images/wrench-reply-sms.png]]

4. 回复邮件

   这个也是针结Smartisan T1手机做过优化的。当您在用T1的邮件程序阅读一封邮件时，您可以直接操作小扳手回复邮件。默认它会群回，也就是点下图正中间的那个按钮，但如果您已经自己点了单独回复，那小扳手也可以很智能的识别出来哦。同样，这个功能应该也不支持其他厂商的手机，因为大家的界面不一样🃏。

   [[./../../../../images/wrench-reply-email.png][file:../../../../images/wrench-reply-email.png]]

5. 微博分享

   既能分享文字，也可以分享图片哦！当然也可以既有文字又有图片的分享，怎么操作呢，你猜嘛👌

6. 微信朋友圈分享

   跟上面一样，也可以同时分享文字和图片啊！👍

7. 同时分享微博和朋友圈

   啊，你只要把两个分享的按钮都选中，再点发送，就可以同时分享到微博和微信朋友圈了！是不是太淘气了？🐵

8. 丰富的表情

   - 所有iPhone手机上支持的表情（比如在iPhone上输入中文葡萄，会出现一串彩色的葡萄🍇）。在小扳手上，你可以点表情按钮，然后输入grape再回车（抱歉，只能用英文）。您也可以用鼠标双击选择表情啦✌。
   - 所有微信/QQ系的表情
   - 大部分的微博表情，包括那些贱贱的浪小花的表情哦🌝

9. 可编程

   比如锤子科技员工可以用小扳手通过微信点锤子科技咖啡，见 [[http://www.bilibili.com/video/av6403550/][这个bilibili视频]]。

10. 所有平台上都可以用

    - Windows
    - Mac
    - Linux

* 怎么用小扳手

很简单的，您只要下载、安装、运行、连接手机，就可以开始使用小扳手了🌞！
** 下载
首先，您需要下载小扳手。官方的地址是：

https://github.com/SmartisanTech/Wrench-releases/releases

请按您的系统平台选择最新版本下载。一般出版本的时候会同步出Windows和Mac的版本，Linux版本因为发行版太多，可能需要您自己编译了😑。

** 安装

小扳手是一款绿色软件，不需要安装，您只要解压就可以了哦！

** 运行

- Windows :: 解压之后双击Wrench.exe开始运行
- Mac :: 解压之后双击Wrench.app开始运行
- Linux :: 解压之后运行./Wrench。请参考 [[./../../../2015/10/22/0-How-to-run-Wrench-under-Linux-including-Ubuntu-12.04.org][怎么在Linux下使用小扳手]] 。

** 连接手机

这一步稍微麻烦一点，但是也只是第一次配置的时候有点麻烦，配好了就爽了，所以，加油哦！您都看到这儿了，再加把劲儿！马上就能用上这款神奇的软件了！😅

小扳手启动之后，如果没有连上安卓手机，默认右下角的图标是红色的，意思是没有连接。下面以Windows 7系统为例，详细介绍一下怎么让红灯变成绿灯。

[[./../../../../images/wrench-not-connected.png][file:../../../../images/wrench-not-connected.png]]

0. 确保手机已经开启USB调试

    - 打开开发者模式

      在手机的 “设置” 应用中，滑动到最下方，有一个 “关于本机” ，点进去之后，再滑动到最下方，有一个 “Smartisan OS 版本” ，连续不停地点按它，就能打开开发者模式，如图：

      [[./../../../../images/dev-mode.png][file:../../../../images/dev-mode.png]]

    - 打开 USB 调试

      回到上一级设置，进入 “关于本机” 上方的 “高级设置” ，这时您应该可以看到有一个 “开发者选项” （本来是没有的，上一步刚打开才有的）。点这个 “高级设置” 进入之后，打开 “USB 调试”，选 “确定”（见图）：

      [[./../../../../images/confirm-allow-adb.png][file:../../../../images/confirm-allow-adb.png]]

1. 通过USB线连接PC和手机

2. 安装驱动 （Mac和Linux系统不需要这一步）

   如果您的手机以前没有安装过安卓USB调试驱动的话，这时候打开设备管理器，您会发现有一个打了未知的Android设备，见图：

   [[./../../../../images/android-eclamation-mark.png][file:../../../../images/android-eclamation-mark.png]]

   这时候您可以从小扳手的解压目录下安装Smartisan T1的USB调试驱动，下面用几张图详细的描述如何操作：

   点击右键：

   [[./../../../../images/right-key-adb.png][file:../../../../images/right-key-adb.png]]

   点击属性：

   [[./../../../../images/update-new-driver.png][file:../../../../images/update-new-driver.png]]

   点击更新驱动程序：

   [[./../../../../images/browse-computer-adb-driver.png][file:../../../../images/browse-computer-adb-driver.png]]

   点击浏览计算机以查找驱动程序软件：

   [[./../../../../images/where-adb-driver.png][file:../../../../images/where-adb-driver.png]]

   输入您的Wrench解压的位置，并选中 “包括子文件夹” （如上图，我的Wrench放在了D:盘下面），点击下一步：

   [[./../../../../images/always-install-adb.png][file:../../../../images/always-install-adb.png]]

   选择 “始终安装此驱动程序软件” ：

   [[./../../../../images/installing-adb-driver.png][file:../../../../images/installing-adb-driver.png]]

   安装完毕后出现一个SUMSANG Android Phone（瀑布汗，这个不知道为什么会这样啊，好像跟这台PC上第一次安装USB调试驱动是一台三星手机有关，以后你再插随便什么手机都是SUMSANG的了💦）：

   [[./../../../../images/adb-driver-installed.png][file:../../../../images/adb-driver-installed.png]]

3. 配置Smartisan T1手机的USB调试

   由于我们公司起步较晚，在我们用USB调试的时候，需要一个额外的步骤，PC才能连上手机的USB调试，否则小扳手认不出T1手机。现在我把这个步骤给打包到小扳手里了，具体技术细节就不说了，我们看一下怎么用小扳手操作吧：

   点一下图中标识的小扳手上的 “设置” 按钮 （跟T1手机上的设置按钮图标是一样的😆），弹出的提示框请点确认：
   [[./../../../../images/ask-if-config.png][file:../../../../images/ask-if-config.png]]

   然后应该会出现一个这样的提示框，没有关系，点确定就好了：

   [[./../../../../images/done-config.png][file:../../../../images/done-config.png]]

   小扳手的这个提示框应该只会出现一次，以后再也不会出现了。如果没有出现，那么可能你的这个步骤已经之前配过了，不用担心🃏。

4. 在手机上接受小扳手的连接请求

   完成了上面的配置之后，T1手机上应该会出现这样的一个对话框，这是因为小扳手现在能认出T1手机了，所以就会尝试连接手机，但手机上必须同意小扳手的连接才可以：

   [[./../../../../images/allow-adb-on-phone.png][file:../../../../images/allow-adb-on-phone.png]]

   勾选 “永远允许这台电脑” 并点击确定，小扳手的图标应该就会变绿了！㊗贺！

5. 最后一步 <<install.setclip>>

   慢着！高兴得有点早了😂。小扳手要正确运行，它会往您的手机里安装一个小应用（就像豌豆荚、91手机助手等软件一样，只不过小扳手的应用比起来要小得多）。因为Smartisan T1手机的安全设置的关系，这个应用安装一般都是会失败的，所以它会弹出一个这样的框来：

   [[./../../../../images/setclip-install-error.png][file:../../../../images/setclip-install-error.png]]

   这时候您需要做如下操作：

   点开 设置 ，选 “锁屏和安全” （如图）

   [[./../../../../images/adb-sec.png][file:../../../../images/adb-sec.png]]

   选 “应用程序安装来源管理” （如图）

   [[./../../../../images/apk-source-sec.png][file:../../../../images/apk-source-sec.png]]

   勾选上 “未知来源” ，选 “确定” （不用担心，我们之后再关掉这个不安全的选项）

   [[./../../../../images/adb-source-confirm.png][file:../../../../images/adb-source-confirm.png]]

   重新插拔一下手机USB线，这回小扳手的绿灯亮起的时候应该就不会再弹出那个出错的框的（如果还弹的话，请您到 [[http://bbs.smartisan.cn/forum-100-1.html][锤子科技bbs论坛]] 上发个贴子@一下我反馈这个问题，如果我没有时间，说不定也会有热心的朋友帮您解决。反馈问题时最好有截屏，手机上的和PC上的，这样才方便大家帮你）。

   然后，您就可以试着点一下小扳手上那个大拇指👍，给我点个赞啦！
   最后，不要忘了把之前手机上点开的那个 “未知来源” 的选项给关掉，省得不小心被装了流氓软件😼。这个我觉得小米的系统做得不错，从USB上安装软件的时候会提示你同意/拒绝，这样用户就能有知情权了，虽然您可能会觉得说每次都提示会不会太麻烦了？
* 常见问题

（以下的常见问题有一部分抄录自之前的版本说明书）

- <<runtime-error>> 程序后台出错。

  1. 确认自己的小扳手已经是最新版本（到这个网页上看一下有没有新版本： https://github.com/SmartisanTech/Wrench-releases/releases ），如果不是最新版本的话，请先升级到最新版本再试一下。

  2. 如果还有错，向我反馈问题时，请尽量将问题描述清楚。

     * 能截张图的话就截张图。
     * 尽量说清楚是执行了什么步骤的情况下出错（小扳手配置过程中？使用过程中？发微信消息时？等等）
     * 太笼统的话，我无法提供帮助（可能直接当作没看见😏）。

- 图片选择错误。

  在发送图片时可能会发生这种错误，原因不明，估计应该是跟手机相册的图片排序方法有关。比如手机上最新的照片是今天拍摄的，这时你想发送一张电脑上的老照片，这时候很可能在相册里这张老照片会排到新照片的后面。小扳手的工作方式是把要上传的图片发送到手机上，然后就认定这些图片因为是手机上最新的图片，所以应该排在最前...

- 偶尔操作失常。

  小扳手的操作方式基本上是非常机械化的，相当于人用手机聊天时各种动作的一个录制回放，所以偶尔某些步骤不一致时操作会失败。比如有时手机在后台打开一个大文件，然后QQ聊天的窗口打开速度慢了一点...

- 其他手机支不支持？

  从小扳手 3.1.3 版开始，理论上只要是安卓手机，都支持小扳手。

  小扳手操作的原理是通过在屏幕上伪装点击事件，不同的手机分辨率对小扳手会有些影响。一般来说，小扳手已经对不同屏幕的窗口控件座标进行按比例缩放，但比较遗憾的是，有些屏幕分辨率下，有些App的窗口控件并不是按比例缩放的...

  所以小扳手的某些功能在某些手机上会有问题，如果需要的话，可以考虑自己对自己的手机进行一些适配（具体请阅读 wrench.lua 里的源代码）。

  另外，有两家的手机 （meizu 和 LG 的），它们的系统有点特殊，小扳手在这两家的系统上只能输入文字，但不能发送。详情见 [[./../../../2015/09/19/0-Wrench-changelog-and-download-location.org][修改记录]] 页面上关于 3.1.0 版的说明。

- 我的PC系统是Windows 8，驱动装不上？

  这个还比较麻烦，但幸好只需要安装一次😅，请参考： http://bbs.pcbeta.com/viewthread-1122886-1-1.html

- 怎么关掉开发者模式

  从 设置 -> 高级设置 -> 应用程序管理 -> 设置 -> 清除数据 一路点进去，就可以关闭开发者模式了。

- 小扳手的快捷键

  小扳手有很多快捷键的哦，不知道大家有没有发现。下面跟大家说一说这些快捷键，下文中C-代表Ctrl键，M-代表Alt键，比如C-b就是按着Ctrl不放再按下b，M-f就是按着Alt不放，再按下f键。M-键也可以先按一下Esc键放开，再按一下后面的主键。

    C-b: 向后移动一个字符（b for back），也可以用Left

    C-f: 向前移动一个字符（f for forth)，也可以用Right

    M-b: 向后移动一个单词，也可以用C-Left

    M-f: 向前移动一个单词，也可以用C-Right

    C-p: 向上移动一行，Up (p for prev)

    C-n: 向下移动一行，Down (n for next)

    C-a: 移动到行首，Home (a是第一个字母）

    C-e: 移动到行末，End (e for end)

    C-d: 删除下一个字符，Delete (d for delete)

    C-v: 向下翻动一页，对不起不是大家熟悉的粘贴功能（v看起来是向下的箭头）

    M-v: 向上翻动一页。

    M-<: 移动到全文最开始，也可以用C-Home（<看起来像什么？）

    M->: 移动到全文最末尾，也可以用C-End （>看起来像什么？）

    C-y: 粘贴

    C-k: 删除本行余下的内容。(k for kill)

    M-* 或 M-8: 打开表情选择窗口（^_*）

    在表情选择窗口里，你可以输入文本进行表情过滤，比如输入“weixin xiao”，可以过滤出微信的4个笑的表情。这里也有几个快捷键可以用：

    C-n: 选择下一个表情

    C-p: 选择上一个表情

    Enter: 输入当前选中的表情

    Shift-Enter: 输入当前过滤出来的所有表情

    这些快捷键是让我自己也可以一直用小扳手聊天的源动力之一，没有这些快捷键的话小扳手对我的吸引力就大打折扣啊。希望你也喜欢￼

- <<exporting.contacts>> 怎么把手机上的联系人导出给小扳手用？

  您可以从“设置”、“联系人”、

  [[./../../../../images/setting-export-contact.png][file:../../../../images/setting-export-contact.png]]

  “导入/导出”

  [[./../../../../images/imp-exp-setting-export-contact.png][file:../../../../images/imp-exp-setting-export-contact.png]]

  “导出联系人”

  [[./../../../../images/export-contact.png][file:../../../../images/export-contact.png]]

  一路点下去把联系人导出到 =/sdcard/smartisan/contact/0000X.vcf= 文件：

  [[./../../../../images/confirm-export-contact.png][file:../../../../images/confirm-export-contact.png]]

  然后把手机连上你的PC之后，在便携式设备里可以看到这个文件，把它拷贝到你的小扳手解压目录下，重命名为 =contacts.vcf= *并且重启小扳手* 就可以了。注意，最新版本的小扳手重启必须从系统托盘里退出再重启，直接关闭小扳手窗口然后重新双击小扳手程序图标，弹出来的还是原来的小扳手窗口，并没有重启过😅。

  [[./../../../../images/exported.vcf-on-pc.png][file:../../../../images/exported.vcf-on-pc.png]]

* 版本变更记录

** <<notifications>> V3.1.3 小扳手接收手机通知、抢红包

居然还有同学想要用小扳手，🙏。

最新版本的小扳手（3.1.3），已经支持接收手机端的通知，但前提是要在手机设置里打开小扳手辅助应用接收通知的权限。

在锤子科技的手机上，打开该权限的方法是运行（不知道怎样从手机屏幕上找到相应的入口）：

#+BEGIN_SRC sh
adb shell am start -n com.android.settings/com.android.settings.NotificationAccessSettingsActivity
#+END_SRC

然后，点击开关并确认，如图：

[[./../../../../images/wrench-allow-notification.png][file:./../../../../images/wrench-allow-notification.png]]

如果是其他品牌的手机，或最新版本的安卓系统（7.0），有可能上述命令是找不到的，请用Google自行搜索，比如 [[http://www.enhancedsmscallerid.com/home/faq/how-do-i-enable-notifications-for-other-apps][这个页面]]。

- *Bug注意*：有时候这个开关打开之后，小扳手能收到通知，但点击不管用。这时候需要：

  1. 进入此设置页面

  2. 断开手机USB线

  3. 重新关闭、打开一遍该开关。

  有可能要多试几次。

然后，可以试着用别的手机微信（或自己用锤子手机的应用双开功能再开一个微信账号）给自己发一个红包，如果能抢到的话，就说明相关通知功能都是OK的。

在系统的通知栏小扳手的图标上，可以右键点击，有一个查看所有通知的选项，如图：

[[./../../../../images/wrench-tray-popup-menu.png][file:./../../../../images/wrench-tray-popup-menu.png]]

点击后，弹出这样的一个对话框，最新收到的消息在最下面，如果双击这条消息的话，一般可以在手机上打开相应的App并跳转到相关的页面（抢红包功能就是基于此实现的，自动点击红包通知）。

[[./../../../../images/wrench-show-notifications.png][file:./../../../../images/wrench-show-notifications.png]]

注意上图中所有的消息都显示了相关的App的图标，前提是你已经点击过小扳手的“Launcher”按钮，通过它启动过应用了，见下图：

[[./../../../../images/wrench-launcher-button.png][file:./../../../../images/wrench-launcher-button.png]]

具体的实现，请参考相关源代码（在wrench.lua中，请顺藤摸瓜）。

** V2.3.0 <<V2.3.0>>

见 http://baohaojun.github.io/blog/2015/01/26/0-T1Wrench-2.3.0-Released.html

** V2.2.0 <<V2.2.0>>

小扳手 V2.2.0发布，这一版加上了打电话的功能。下载地址在 http://t.cn/RZMWJgn 。

使用方法是点击那个 “电话” 按钮，然后在弹出来的对话框里输入电话号码，或输入文字以选择匹配的联系人。注意如果你的联系人里有“包昊军”的话，在我厂的手机上你可以用bhj来匹配到我，但在小扳手上是不行的，但你可以试试 =b h j= 。

[[./../../../../images/phone-call-howto.png][file:../../../../images/phone-call-howto.png]]

电话按钮的快捷键是 “Alt-&” 或 “Alt-7”，因为 =&= 的意思是“和”，你和你的意中人💓。都说了，早点用上小扳手，早点追到女朋友💕。

需要您手动把手机上的联系人导出成.vcf文件，然后拷贝到小扳手的解压目录下，重命为contacts.vcf，具体步骤请看 http://t.cn/RZMjSjs 实在抱歉目前只能您受累🙇，以后咱们再考虑做成自动同步联系人👻。

选联系人的操作界面简直跟选表情的界面一模一样，包括几乎所有的快捷键。由此您可以看出我的#村炮编程哲学#😼。

如果您没有导出过联系人的话，那电话也还是可以打的，但是您只能自己输入电话号码并按回车了😭。

注意目前您必须在 “设置”、“强迫症选项”、“拨号面板设置” 里选对称的拨号面板，否则不会拨打电话，只会在您输入的号码后面加一个零。以后我再考虑怎么更人性化一点。

[[./../../../../images/call-mode-centered.png][file:../../../../images/call-mode-centered.png]]

另外还有一些小细节（其中第三条特别重要，您需要按照 http://t.cn/RZMYoSW 这里的说明确保安装成功）：

- 修正某些微信表情不可用的Bug

- 修正微信聊天发送按钮位置，输入多行文字时也可正确发送

- 更新SetClip.apk，需要打开“未知来源”重新安装一下

- 可以拨打电话

- 修正了Windows上所有微博、微信表情中文字符显示错误
